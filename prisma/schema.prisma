generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = "postgresql://postgres:admin123@localhost:5432/TurkishFir1807_DB?schema=public&connection_limit=5"
}

model TBL_USUARIOS {
  id                String    @id @default(uuid())
  nombre            String
  correoElectronico String
  contrasena        String
  ultimaConexion    DateTime? @default(now())
  imagenPerfil      String?
  estado            String?   @default("Activo") // * Bloqueado, Activo, etc...
  id_rel_role       String

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt

  TBL_REL_PERMISOS_ROLES TBL_REL_PERMISOS_ROLES @relation(fields: [id_rel_role], references: [id])
}

model TBL_ROLES {
  id                     String                   @id @default(uuid())
  nombre                 String
  descripcion            String
  TBL_REL_PERMISOS_ROLES TBL_REL_PERMISOS_ROLES[]
}

model TBL_PERMISOS {
  id          String   @id @default(uuid())
  nombre      String
  descripcion String
  acciones    String[]

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt

  TBL_REL_PERMISOS_ROLES TBL_REL_PERMISOS_ROLES[]
}

model TBL_REL_PERMISOS_ROLES {
  id         String @id @default(uuid())
  id_role    String
  id_permiso String

  TBL_ROLES    TBL_ROLES      @relation(fields: [id_role], references: [id])
  TBL_PERMISOS TBL_PERMISOS   @relation(fields: [id_permiso], references: [id])
  TBL_USUARIOS TBL_USUARIOS[]
}

model TBL_CLIENTES {
  id              String   @id @default(uuid())
  DNI             String   @unique
  primerNombre    String
  segundoNombre   String
  primerApellido  String
  segundoApellido String?
  otroNombre      String
  telefono        String
  fechaNacimiento DateTime
  fechaDeIngreso  DateTime //* Se guardara la fecha actual en la que se registro el cliente
  id_municipio    String
  id_contrato     String?

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt

  municipio TBL_MUNICIPIO  @relation(fields: [id_municipio], references: [id], onDelete: NoAction)
  contratos TBL_CONTRATOS? @relation(fields: [id_contrato], references: [id], onDelete: Cascade)

  rutinas  TBL_RUTINAS[]
  chequeos TBL_INFORMACIONCHEQUEO[]
}

model TBL_MUNICIPIO {
  id     String @id @default(uuid())
  nombre String
  codigo String @unique

  createdAt    DateTime?      @default(now())
  updatedAt    DateTime?      @updatedAt
  TBL_CLIENTES TBL_CLIENTES[]
}

model TBL_CONTRATOS {
  id               String   @id @default(uuid())
  descripcion      String?
  fechaDeInicio    DateTime
  fechaDeFin       DateTime
  ultimaRenovacion DateTime
  estado           String //* Vencido o Activo -> Activarselo una vez que el Cliente Pague

  createdAt    DateTime?      @default(now())
  updatedAt    DateTime?      @updatedAt
  TBL_CLIENTES TBL_CLIENTES[]
}

model TBL_INFORMACIONCHEQUEO {
  id              String   @id @default(uuid())
  peso            String
  estatura        String
  nivelDeMasa     String?
  nivelDeGrasa    String?
  fechaDelChequeo DateTime
  id_cliente      String // TODO Se guardara automaticamente al hacer el chequeo...

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt

  TBL_CLIENTES TBL_CLIENTES   @relation(fields: [id_cliente], references: [id], onDelete: Cascade)
  TBL_PROGRESO TBL_PROGRESO[]
}

model TBL_PROGRESO {
  id         String @id @default(uuid())
  peso       Float? @default(0.00)
  perdida    Float? @default(0.00)
  id_chequeo String

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt

  TBL_INFORMACIONCHEQUEO TBL_INFORMACIONCHEQUEO @relation(fields: [id_chequeo], references: [id], onDelete: Cascade)
}

model TBL_RUTINAS {
  id                    String @id @default(uuid())
  nombre                String
  cantidad_series       Int
  cantidad_repeticiones Int
  tiempo_descanso       Float //* En minutos

  id_ejercicio          String
  id_objetivosCatalogos String
  id_cliente            String

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt

  TBL_EJERCICIO TBL_EJERCICIO @relation(fields: [id_ejercicio], references: [id])
  TBL_CLIENTES  TBL_CLIENTES  @relation(fields: [id_cliente], references: [id], onDelete: Cascade)
}

model TBL_EJERCICIO {
  id          String  @id @default(uuid())
  nombre      String
  descripcion String
  imagen      String?
  id_tipo     String

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt

  TBL_TIPOSEJERCICIOS TBL_TIPOSEJERCICIOS @relation(fields: [id_tipo], references: [id])
  TBL_RUTINAS         TBL_RUTINAS[]
}

model TBL_TIPOSEJERCICIOS {
  id          String @id @default(uuid())
  nombreTipo  String
  descripcion String

  createdAt DateTime? @default(now())
  updatedAt DateTime? @updatedAt

  TBL_EJERCICIO TBL_EJERCICIO[]
}

// qwe
